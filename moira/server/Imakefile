# $Header: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/server/Imakefile,v 1.2 1993-10-21 14:50:30 mar Exp $
#
# Copyright 1990 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Imakefile for server directory.
#

#ifdef INGRES
XSRC= mr_sbrk.c meinitlst.c
XOBJ= mr_sbrk.o meinitlst.o
#else
XSRC=
XOBJ=
#endif

DEFINES=-DGDSS -I/mit/gdss/include -I.

SRCS = startmoira.c mr_main.c mr_sauth.c mr_scall.c \
	mr_srvdata.c mr_shutdown.c mr_util.c qrtn.c \
	qsupport.c qsubs.c queries2.c mr_smalloc.c \
	increment.c cache.c mr_glue.c \
	mr_server.h query.h qrtn.h $(XSRC)
CODE= startmoira.c mr_main.c mr_sauth.c mr_scall.c \
	mr_srvdata.c mr_shutdown.c mr_util.c qrtn.dc \
	qsupport.dc qsubs.c queries2.c mr_smalloc.c \
	increment.dc cache.dc mr_glue.c \
	Imakefile mr_server.h query.h qrtn.h $(XSRC)
SRVOBJ=mr_main.o mr_sauth.o mr_scall.o mr_srvdata.o mr_shutdown.o \
	mr_util.o qrtn.o queries2.o qsupport.o qsubs.o \
	mr_smalloc.o increment.o cache.o $(XOBJ)
GLUOBJS=mr_glue.o qrtn.o queries2.o qsupport.o qsubs.o \
	../lib/mr_et.o mr_srvdata.o mr_smalloc.o \
	../lib/krb_et.o mr_util.o increment.o cache.o $(XOBJ)
SRCDIR = $(SRCTOP)/server
sqlrule()

program(moirad, ${SRVOBJ},${MR_LIBDEP} ${GDB_LIBDEP},\
	-L/usr/athena/lib .././lib/libmoira.a -lzephyr \
	.././gdb/libmrgdb.a  -lcom_err \
	/mit/gdss/`machtype`/libgdss.a -lkrb -ldes -lhesiod \
	${SQL_LIB}, ${PROGDIR})
program(startmoira, startmoira.o,,, ${PROGDIR})
library_obj_rule()
install_library_target(mrglue,$(GLUOBJS),$(SRCS),)

sqlfile(cache)
sqlfile(increment)
sqlfile(qrtn)
sqlfile(qsupport)
