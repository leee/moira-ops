# $Header: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/Imakefile,v 1.2 1991-03-08 11:34:49 mar Exp $
#
# Copyright 1990 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Imakefile for top level directory.
#

#define have_subdirs
CODE=Imakefile
CLIENTDIRS=util include gdb lib clients man update
SVRDIRS=server db backup dbck dcm gen reg_svr incremental regtape
#ifdef SVRBUILD
SUBDIRS=$(CLIENTDIRS) $(SVRDIRS)
#else
SUBDIRS=$(CLIENTDIRS)
#endif

all:: 

#ifndef USELOCALTOOLS

world::
	make ${MFLAGS} clean-imake
	make ${MFLAGS} Makefile
	make ${MFLAGS} Makefiles
	make ${MFLAGS} depend
	make ${MFLAGS} all

clean-imake:
	cd util/imake; make clean
	cd util/imake; make

imake::
	cd util/imake; make 

#else /* USELOCALTOOLS */

world::
	make ${MFLAGS} Makefile
	make ${MFLAGS} Makefiles
	make ${MFLAGS} depend
	make ${MFLAGS} all
#endif /* USELOCALTOOLS */


install::
	-mkdir ${DESTDIR}
	-mkdir ${DESTDIR}${USRDIR}
	-mkdir ${DESTDIR}${ETCDIR}
	-mkdir ${DESTDIR}${PROGDIR}
	-mkdir ${DESTDIR}${LIBDIR}
	-mkdir ${DESTDIR}${LINTLIBDIR}
	-mkdir ${DESTDIR}${INCLDIR}
	-mkdir ${DESTDIR}${MANDIR}
	-mkdir ${DESTDIR}${MANDIR}/man1
	-mkdir ${DESTDIR}${MANDIR}/man3
	-mkdir ${DESTDIR}${MANDIR}/man5
	-mkdir ${DESTDIR}${MANDIR}/man8
	-mkdir ./bin

#ifdef USELOCALTOOLS
depend::
	cd util/makedepend; make
#endif

#ifdef USELOCALLIBS
depend::
	cd util/et; make ${MFLAGS} DEPEND=../../$(DEPEND) depend; make ${MFLAGS} all
	cd util/ss; make ${MFLAGS} DEPEND=../../$(DEPEND) depend; make ${MFLAGS} all
#endif
