# Makefile generated by imake - do not edit!
# $XConsortium: imake.c,v 1.51 89/12/12 12:37:30 jim Exp $
#
# The cpp used on this machine replaces all newlines and multiple tabs and
# spaces in a macro expansion with a single space.  Imake tries to compensate
# for this, but is not always successful.
#

#
# This makefile is automatically generated by imake... do not modify
# or you may lose your changes when imake generates makefiles again.
# Ignore this message if you are not using imake.
#
#	$Source: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/util/makedepend/Makefile,v $
#

NEWTOP=.
BUILDTOP=.

INCLUDE= -I$(BUILDTOP)/include -I$(BUILDTOP)/lib -I/usr/athena/include
CFLAGS=$(DBG) $(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)
LINTFLAGS=$(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)

#	$Source: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/util/makedepend/Makefile,v $
#

CURSES= -L/usr/css/lib -lcurses -ltermcap

OSDEFS= -DPOSIX -DSOLARIS -I/usr/openwin/include
OSLIBS= -L/usr/ccs/lib -lcurses -ltermcap -lresolv \
	-lsocket -lnsl -lc /usr/ucblib/libucb.a -lelf -ldl
CURSES=

GLOBAL_CDEFS= -DHESIOD -DZEPHYR -DGDSS -DATHENA -DDBMS=INGRES -I/usr/athena/include $(OSDEFS)

SRCTOP=/mit/moiradev/src

DESTDIR=

USRDIR= /usr
ETCDIR= /usr/athena/etc
PROGDIR=/usr/athena/bin
LIBDIR= /usr/athena/lib
LINTLIBDIR = /usr/lib/lint
INCLDIR= /usr/athena/include
MANDIR= /usr/athena/man

LZEHPYR=-lzephyr

LIBGDSS= /mit/gdss/`machtype`/libgdss.a
GDSSINC= -I/mit/gdss/include

LINTLIBFLAG=-C

MR_LIB=$(BUILDTOP)/lib/libmoira.a
MR_LIBDEP=$(MR_LIB)
MR_LINTLIB=$(BUILDTOP)/lib/llib-lmoira.ln
GDB_LIB=$(BUILDTOP)/gdb/libmrgdb.a
GDB_LIBDEP=$(GDB_LIB)
GDB_LINTLIB=$(BUILDTOP)/gdb/llib-lmrgdb.ln

COMPILE_ET= compile_et

COM_ERR = -lcom_err

MAKE_COMMANDS= mk_cmds

SS_LIB = -lss

LLIB = -L/usr/athena/lib

CLIBS= $(MR_LIB) $(GDB_LIB) $(LLIB) $(LZEPHYR) $(COM_ERR) -lkrb -ldes -lhesiod

SQL_LIB= /usr/ingres/lib/libingres.a -lm

ARCHIVE= ar cru

RANLIB= /bin/true

INSTALLFILE= install -c -m 444

INSTALLLIB= install -c -m 444

INSTALLPROG= install -c -m 555

INSTALLRAW= install

LD=ld

AS=as

LINT=lint

CC=gcc -traditional

CCRO=$(CC) -R

HCC=$(CC)

CPP=$(CC) -E

DBG=-O

HCFLAGS=$(CFLAGS)

TAGGER=etags

MAKE=make
RM=rm -f
MV=mv
CP=cp
LN=ln -s
LPR=lpr -p
CHMOD=chmod
AWK=awk

DEPEND=makedepend
IMAKE=imake -I$(BUILDTOP)/util/imake.includes

#	$Source: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/util/makedepend/Makefile,v $
#

# $Source: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/util/makedepend/Makefile,v $
# $Author: danw $
# $Header: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/util/makedepend/Makefile,v 4.1 1996-07-08 21:51:34 danw Exp $
#
# Copyright 1987 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Utility to build makefile header dependancies from C source.
#
# If you have source for cpp...
#

#
# But if you don't have cpp source...
#
SRCS = include.c main.c parse.c pr.c cppsetup.c
SOURCES = \
	${SRCDIR}/util/makedepend/include.c \
	${SRCDIR}/util/makedepend/main.c \
	${SRCDIR}/util/makedepend/parse.c \
	${SRCDIR}/util/makedepend/pr.c \
	${SRCDIR}/util/makedepend/cppsetup.c \
	${SRCDIR}/util/makedepend/def.h \
	${SRCDIR}/util/makedepend/Imakefile \
	${SRCDIR}/util/makedepend/Makefile
OBJS = include.o main.o parse.o pr.o cppsetup.o
DEFINES = '-DINCLUDEDIR="/usr/include"'

CODE=$(SRCS) Imakefile

all:: makedepend

makedepend: $(OBJS)
	$(CC) $(CFLAGS) -o $@ $(OBJS)  $(OSLIBS)

clean::
	$(RM) makedepend $(OBJS)

cpy.c: cpy.y yylex.c
	yacc cpy.y
	sed -e '/^# *line/d' < y.tab.c > cpy.c
	$(RM) y.tab.c

cpy.y: $(CPPSRC)/cpy.y
	$(RM) $@
	$(LN) $(CPPSRC)/cpy.y .

yylex.c: $(CPPSRC)/yylex.c
	$(RM) $@
	sed -e 's/#if pdp11 | vax | mc68000/& | ns16000 | ibm032/' \
		$(CPPSRC)/yylex.c > yylex.c

cpp.c: $(CPPSRC)/cpp.c cpp.ed
	$(RM) cpp.c
	/lib/cpp $(CPPSRC)/cpp.c \
		| cb \
		| sed -e '/^$$/d' -e '/^#/d' -e 's/	/ /g' > cpp.c
	sed -e '/^#/d' < cpp.ed | ed - cpp.c

cpp.o: cpp.c
cpy.o: cpy.c

clean::
	$(RM) cpp.c cpy.? yylex.c

config: $(SOURCES)
	-mkdir $(DESTDIR)/util/makedepend
	for i in $(SOURCES); do \
		$(RM) ${DESTDIR}/util/makedepend/`basename $$i`; \
		$(CP) $$i ${DESTDIR}/util/makedepend/`basename $$i`; done

depend:: $(SRCS)
	@echo "### Now computing dependencies"
	@$(DEPEND) -s "# DO NOT DELETE" -- $(CFLAGS) -- $(SRCS)

clean::
	$(RM) *~ \#* *.bak $(TAGSFILE)

tags::
	$(TAGGER) *.c *.h

Makefile::
	-$(RM) Makefile.bak; $(MV) Makefile Makefile.bak
	$(IMAKE) -DNEW_TOP=$(NEWTOP) -s Makefile

print:: ${CODE}
	${LPR} ${CODE}

src:: ${CODE}

${CODE}:
	$(RM) $@
	-$(LN) ${SRCDIR}/$@ $@

install::

Makefiles::

# DO NOT DELETE THIS LINE

