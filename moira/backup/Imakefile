# $Header: /afs/.athena.mit.edu/astaff/project/moiradev/repository/moira/backup/Imakefile,v 1.7 1998-02-05 22:50:19 danw Exp $
#
# Copyright 1990 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Imakefile for backup directory.
#

SRCS= dump_db.h dump_db.c bkup1.c bkup.c dumprest.c rest_db.c rest1.c rest.c
SRCDIR=${SRCTOP}/backup
CODE= db2bkup.awk db2rest.awk dump_db.h dump_db.pc dumprest.pc \
	nightly.sh report.sh rest_db.pc
BOBJS= dump_db.o bkup1.o bkup.o dumprest.o 
ROBJS= rest_db.o rest1.o rest.o dumprest.o
sqlrule()

program(mrbackup, ${BOBJS},${MR_LIBDEP}, ${CLIBS} ${SQL_LIB}, ${PROGDIR})
program(mrrestore, ${ROBJS},${MR_LIBDEP}, ${CLIBS} ${SQL_LIB}, ${PROGDIR})

bkup.pc: ../db/schema.sql db2bkup.awk
	awk -f db2bkup.awk < ../db/schema.sql > bkup.pc
bkup1.pc: bkup.pc
rest.pc: ../db/schema.sql db2rest.awk
	awk -f db2rest.awk < ../db/schema.sql > rest.pc
rest1.pc: rest.pc
clean::
	$(RM) bkup.pc bkup1.pc bkup.h rest.pc rest1.pc rest.h
sqlfile(dump_db)
sqlfile(rest_db)
sqlfile(dumprest)
sqlfile(bkup)
sqlfile(bkup1)
sqlfile(rest)
sqlfile(rest1)
